<!--
author: Justin
head: 
date: 2021-06-06
title: redis基础数据结构
tags: redis
images: http://pingodata.qiniudn.com/cube2.jpg
category: 软件开发
status: publish
summary: 
-->

## 五种基础数据结构

string、list、hash、set、zset


### string

string是redis里最简单的数据结构。

string是动态字符串。

什么叫动态字符串？--> 就是可以修改的字符串。内部结构类似于java的ArrayList，采取预分配冗余空间的方式来减少内存的频繁分配。

比如：当前字符串分配的实际空间capacity，一般会高于实际字符串的长度len。当字符串长度小于1MB时，扩容都是加倍现有空间，如果字符串长度超过1MB，扩容一次只会扩容1M空间。字符串最大的长度512MB

```
伪代码逻辑：

len:字符串长度
catacity:实际空间大小

function void reSize(int len,int catacity){

    if(len > 1M){
        catacity += len;
    }else{
        catacity += 1M;
    }    
}
```

#### key-value

常见操作:

```
> set key value;
OK
> get key;
"value"
> del key;
(nil)
> exists key;
（integer）1
```

#### 批量key-value

```
> set key1 v1
OK
> set key2 v2
OK
> mget key1 key 2 key3
#返回一个列表
v1
v2
（nil）
> mset key1 v1 key2 v2 key3 v3
> mget key1 key2 key3
v1
v2
v3
```

#### 过期与set命令扩展

可以对key设置过期时间，到时间自动删除。
```
> set key value
> get key
value
> expire key 5 #5s后过期
等5s后
> get key
nil

> setex key 5 value
> get key

> setnx key value # 只在键 key 不存在的情况下， 将键 key 的值设置为 value 。
1/0 1 设置成功 0key已存在

```

#### 计数

如果value的值是一个整数，可以对它进行自增操作。自增有范围 signed long 的最大最值

```
> set age 30
> incr age
31
> incrby age 5
36
> incrby age -5
31
> set key #Long.Max
> incr key
#抛出异常
```

### list

Redis的list相当于java中的LinkedList，注意是链表而不是数组。所以插入、删除操作很快，时间复杂度O(1).但是索引定位很慢，时间复杂度O(n).

链表是双向链表，当列表弹出最后一个元素后，数据结构被自动删除，内存回收。

Redis的list常用来做异步队列使用。可以模拟队列、栈、慢操作、快速列表等操作。

#### 右边进-左边出 队列
```

```

#### 右边进-右边出 栈

```
```

#### 

### hash

### set

### zset

