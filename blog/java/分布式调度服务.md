<!--
author: Justin
head: 
date: 2021-07-19
title: 分布式调度服务
tags: java
images: http://pingodata.qiniudn.com/cube2.jpg
category: java
status: publish
summary: 本文我们从架构和技术实现上来为大家讲解腾讯云分布式任务调度系统 TCT(Tencent Cloud Task) 如何实现任务调度的精准实时、稳定高效，以及任务的切分和编排。
-->

## 背景介绍

#### 缘起缘灭，自有因果

首先，我们来思考一些几个业务场景：

* XX 信用卡中心，每月 28 日凌晨 1:00 到 3:00 需要完成全网用户当月的费用清单的生成。
* XX 服饰，需要每天上午 9:00 开始向会员推送送生日祝福短信。
* XX 游戏平台，新用户注册后，需要为当前用户生成定时任务，在月底清算虚拟货币兑换的佣金额度。
* XX 公司，需要定时执行 Python 脚本，清理掉某文件服务系统中无效的 tmp 文件。
* XX 保险公司，需要每天凌晨 2:00 统计前一天新增保单数量，并触发报表生成任务，完成后抄送邮件。

类似上述批量处理海量定时任务的业务场景，在企业从单体架构向微服务架构、云化服务架构演进过程中已经屡见不鲜，基于 Quartz 的常规调度框架无法应对这种分布式场景下的需求，既无法实现任务调度的精准实时、稳定高效，也无法实现任务的切分、编排、失败补充。因此企业迫切需要一款一站式分布式调度任务解决方案，帮助企业统一管理繁杂纷乱的定时任务，增强企业微服平台服务化能力，支撑企业云化服务转型。

## 现有的开源方案

#### 它山之石可以攻玉 …

在过往的发展中，前人留下了不少优秀的方案，各有利弊。常见开源产品: Quartz、XXL-Job、ElasticJob、Antares、SIA-TASK 等。

* Quartz：该框架应用最为广泛，其完全基于 Java 实现，Quartz 对单个任务的控制基本做到了极致，以其强大功能和应用灵活性，成为开源任务调度领域的权威及同类开源产品如 Antares 的基石；
* XXL-JOB：一个轻量级分布式任务调度平台，其核心设计目标是开发迅速、学习简单、轻量级、易扩展。XXL-JOB 支持分片，支持简单任务依赖，支持子任务依赖，不支持跨平台的。
* Elastic-Job：支持任务分片（作业分片一致性），没有任务编排，不支持跨平台；
* SIA-TASK：具有跨平台、可编排、高可用、无侵入、一致性、异步并行、动态扩展、实时监控等特点。

开源方案的逻辑架构图

开源方案的技术实现图

从开源方案的逻辑架构和技术实现上，我们也能直观的看出开源方案的不足：

* 架构方面：调度器职责划分不清晰、系统扩展性不足。面对大规模虚拟化 & 复杂的网络环境，简单的远程调用并不能完成胜任。
* 性能方面：ZooKeeper 集群伴随任务量和高频事件的增多，成为系统性能瓶颈。简单的远程调用或者轮训拉取等方案，满足不了量大频高的业务诉求。
* 功能方面：缺乏完整认证鉴权方面的系统设计，安全性无法保障。任务干预、监控告警等系统运维方面能力较弱。

## TCT 简介

为了解决上述问题，我们进行了深入的探索，并设计出了一套企业级的分布式任务调度系统 TCT（Tencent Cloud Task）。TCT 提供一站式分布式调度任务解决方案，支持随机、广播多种任务类型，具备任务分片、任务编排能力，提供完善的监控告警体系。我们结合了用户实际的业务场景，吸取了历史经验，主要解决了面几个核心问题：

以上核心要素，对系统的要求各不相同，可提供如下总结进行参考:

## 技术架构

#### 架构，总是在需求中不断演进…

## 功能架构

